var cols,wrap=document.getElementById("wrap"),number=1,random=generateNumber(),components=[],DragSrcEle=null,DesId="",isDifference=!1,isEmpty=!1,isDropFree=!1;function generateNumber(){for(var e=new Array,t=1;t<=16;t++)e[t-1]=t,e.sort(function(){return Math.round(Math.random())-.5});return e}function CreateRow(){for(var e=0;e<4;e++)CreateCell(random[number-1])}function CreateCell(e){var t=document.createElement("div");t.setAttribute("class","components"),t.classList.add("color"),t.setAttribute("draggable","true"),t.setAttribute("id",number),"16"==e&&(e="",t.classList.remove("color"),t.classList.add("nocolor"),t.removeAttribute("draggable"));e=document.createTextNode(e);t.appendChild(e),components.push({class:t.className,draggable:t.draggable,id:t.id,Text:t.innerText}),wrap.appendChild(t),number++}function CreateWrap(){for(var e=0;e<4;e++)CreateRow();cols=document.querySelectorAll(".components"),[].forEach.call(cols,function(e){e.addEventListener("dragstart",handleDragStart,!1),e.addEventListener("dragover",handleDragOver,!1),e.addEventListener("dragenter",handleDragEnter,!1),e.addEventListener("dragleave",handleDragLeave,!1),e.addEventListener("dragend",handleDragEnd,!1),e.addEventListener("drop",handleDrop,!1)})}function handleDragStart(e){var t;components.forEach(r=>{r.id==e.target.id&&(t=r)}),"nocolor"!=t.class.substr(t.class.indexOf(" "),8).trim()?(DragSrcEle=this,e.dataTransfer.effectAlled="move",e.dataTransfer.setData("SrcId",e.target.id),isEmpty=!1):isEmpty=!0}function handleDragOver(e){return e.preventDefault&&e.preventDefault(),e.dataTransfer.dropEffect="move",!1}function handleDragEnter(e){this.classList.add("over")}function handleDragLeave(e){this.classList.remove("over")}function handleDragEnd(e){if([].forEach.call(cols,function(e){e.classList.remove("over")}),isDifference&&!isEmpty&&isDropFree){for(var t=e.target.attributes.length-1;t>=0;t--)e.target.removeAttribute(e.target.attributes[t].name);components.forEach(t=>{t.id==DesId&&(e.target.setAttribute("class",t.class),e.target.setAttribute("draggable",t.draggable),e.target.setAttribute("id",t.id),e.target.innerHTML=t.Text)})}}function handleDrop(e){var t;if(e.stopPropagation()&&e.stopPropagation(),components.forEach(e=>{e.id==this.id&&(t=e)}),isDropFree="nocolor"==t.class.substr(t.class.indexOf(" "),8).trim(),DragSrcEle!=this&&!isEmpty&&isDropFree){isDifference=!0,DesId=this.id;for(var r=e.dataTransfer.getData("SrcId"),a=this.attributes.length-1;a>=0;a--)this.removeAttribute(this.attributes[a].name);components.forEach(e=>{e.id==r&&(this.setAttribute("class",e.class),this.setAttribute("draggable",e.draggable),this.setAttribute("id",e.id),this.innerHTML=e.Text)})}else isDifference=!1;return!1}